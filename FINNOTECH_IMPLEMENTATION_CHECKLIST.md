# ฺฺฉ ูุณุช ูพุงุฏูโุณุงุฒ APIูุง Finnotech

## โ ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู

### 1. Constants ู ุชูุธูุงุช
- โ Constants ุจุฑุง 4 API URL ุงุถุงูู ุดุฏ (`maneli-car-inquiry.php`)
- โ 4 Switch ุฏุฑ ุชูุธูุงุช Finotex ุงุถุงูู ุดุฏ (`class-settings-page.php`)
  - `finnotech_credit_risk_enabled`
  - `finnotech_credit_score_enabled`
  - `finnotech_collaterals_enabled`
  - `finnotech_cheque_color_enabled`

### 2. ฺฉูุงุณ Handler
- โ ฺฉูุงุณ `Maneli_Finnotech_API_Handler` ุงุฌุงุฏ ุดุฏ (`class-finnotech-api-handler.php`)
- โ 4 ูุชุฏ ุจุฑุง ูุฑุงุฎูุงู APIูุง:
  - `execute_credit_risk_inquiry()`
  - `execute_credit_score_inquiry()`
  - `execute_collaterals_inquiry()`
  - `execute_cheque_color_inquiry()`

### 3. ูุฑุงุฎูุงู ุฎูุฏฺฉุงุฑ
- โ ุฏุฑ `finalize_inquiry()` - ููฺฏุงู ุซุจุช ุงุณุชุนูุงู ุชูุณุท ูุดุชุฑ
- โ ุฏุฑ `handle_admin_create_inquiry()` - ููฺฏุงู ุงุฌุงุฏ ุงุณุชุนูุงู ุชูุณุท ุงุฏูู
- โ ุฏุฑ `handle_admin_retry_finotex()` - ููฺฏุงู retry ุงุณุชุนูุงู

### 4. ุฐุฎุฑูโุณุงุฒ ุฏุงุฏูโูุง
- โ ุฏุงุฏูโูุง ุฏุฑ post meta ุฐุฎุฑู ูโุดููุฏ:
  - `_finnotech_credit_risk_data`
  - `_finnotech_credit_score_data`
  - `_finnotech_collaterals_data`
  - `_finnotech_cheque_color_data`
- โ ุชุงุฑุฎ ุฏุฑุงูุช ุฏุฑ `_finnotech_*_fetched_at` ุฐุฎุฑู ูโุดูุฏ
- โ ุฏุงุฏูโูุง ุจุง ุฎุงููุด/ุฑูุดู ุดุฏู API ุญูุธ ูโุดููุฏ (ุงฺฏุฑ SKIPPED ุจุงุดุฏุ ุฏุงุฏูโูุง ูุจู ุญูุธ ูโุดููุฏ)

### 5. ููุงุด ุฏุฑ ุตูุญู ฺฏุฒุงุฑุด

#### ฺฏุฒุงุฑุด ูุดุชุฑ (`report-customer-installment.php`)
- โ ฺฉุงุฑุช "ุฑุณฺฉ ุจุงูฺฉ ุดุฎุต" - ููุงุด `creditRisk`, `riskScore`, `prohibitedTransactionStatus`, `financialJudgmentStatus`
- โ ฺฉุงุฑุช "ุฏูุงู ฺฉุงูุด ุงูุชุงุฒ ุงุนุชุจุงุฑ" - ููุงุด `negativeFactors`, `scoreHistory`, `creditScore`
- โ ฺฉุงุฑุช "ุฎูุงุตู ูุฑุงุฑุฏุงุฏูุง" - ููุงุด `totalContracts`, `totalLoanAmount`, ูุณุช ูุฑุงุฑุฏุงุฏูุง
- โ ฺฉุงุฑุช "ูุถุนุช ฺฺฉโูุง ุตุงุฏ" - ููุงุด ฺฉุฏ ุฑูฺฏ ฺฺฉ
- โ ููุงุด ุดุฑุท: ููุท ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏู API ู ูุฌูุฏ ุฏุงุฏู

#### ฺฏุฒุงุฑุด ุงุฏูู (`report-admin-installment.php`)
- โ ููุงู 4 ฺฉุงุฑุช (ููุท ุจุฑุง ุงุฏูู)
- โ ููุงุด ุดุฑุท: ููุท ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏู API ู ูุฌูุฏ ุฏุงุฏู

### 6. ูุณุช ุงุณุชุนูุงูโูุง

#### ูุณุช ูุดุชุฑ (`customer-installment-list.php`)
- โ ุจุฑุฑุณ ุฏุงุฏูโูุง Finnotech (ุฎุทูุท 71-86)
- โ ูุดุงูฺฏุฑ ุขฺฉูู ฺฺฉ ุณุจุฒ ุฏุฑ ุณุชูู "Car" (ุฎุท 116-118)
- โ ููุท ุฒูุงู ููุงุด ุฏุงุฏู ูโุดูุฏ ฺฉู ุฏุงุฏู ููุฌูุฏ ุจุงุดุฏ ู API ูุนุงู ุจุงุดุฏ

#### ูุณุช ุงุฏูู (`admin-installment-list.php`)
- โ ูุณุช ุงุฒ ุทุฑู AJAX ุฑูุฏุฑ ูโุดูุฏ (ุงุฒ `render_inquiry_row`)
- โ ูุดุงูฺฏุฑูุง Finnotech ุฏุฑ `class-maneli-render-helpers.php` ุงุถุงูู ุดุฏ (ุฎุทูุท 380-455)
- โ ุขฺฉููโูุง ุฌุฏุงฺฏุงูู ุจุฑุง ูุฑ API:
  - ุฑุณฺฉ ุงุนุชุจุงุฑ (ูุฑูุฒ)
  - ุงูุชุงุฒ ุงุนุชุจุงุฑ (ุฒุฑุฏ)
  - ูุฑุงุฑุฏุงุฏูุง (ุขุจ)
  - ูุถุนุช ฺฺฉ (ุขุจ ูพุฑุฑูฺฏ)
- โ ุฏุงุฏูโูุง Finnotech ุจู AJAX response ุงุถุงูู ุดุฏ (`ajax_get_inquiry_details`)

### 7. ุงุณุชุงู ุฌุฏุงูู
- โ ุฌุฏุงูู ุจุง `table table-bordered table-striped mb-0` ุงุณุชุงู ุดุฏูุฏ
- โ Header ุจุง `bg-light` ฺฉูุงุณ ุงุณุชุงู ุดุฏ
- โ ฺฉุณุงู ุจุง ุณุงุฑ ุฌุฏุงูู ุฏุฑ ูพุฑูฺู

### 8. ูุฏุฑุช ุฎุทุง
- โ ุงฺฏุฑ API ุฎุงููุด ุจุงุดุฏ (SKIPPED)ุ ุฏุงุฏูโูุง ูุจู ุญูุธ ูโุดููุฏ
- โ ุงฺฏุฑ API ูุนุงู ุจุงุดุฏ ุงูุง ุฎุทุง ุฏูุฏ (FAILED)ุ ุฎุทุง ุฐุฎุฑู ูโุดูุฏ
- โ ุฏุฑ ฺฏุฒุงุฑุดุ ูพุงู ููุงุณุจ ููุงุด ุฏุงุฏู ูโุดูุฏ

---

## ๐ ุฎูุงุตู ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู ุฏุฑ ูุณุชโูุง

### ูุณุช ูุดุชุฑ (Static)
1. โ ุฎูุงูุฏู ุฏุงุฏูโูุง 4 API ุงุฒ post meta
2. โ ฺฺฉ ฺฉุฑุฏู ุชูุธูุงุช (ูุนุงู ุจูุฏู ูุฑ API)
3. โ ูุญุงุณุจู `$has_finnotech_data`
4. โ ููุงุด ุขฺฉูู ฺฺฉ ุณุจุฒ ุฏุฑ ุณุชูู "Car" ุงฺฏุฑ ุฏุงุฏู ููุฌูุฏ ุจุงุดุฏ

### ูุณุช ุงุฏูู (AJAX)
1. โ ุฎูุงูุฏู ุฏุงุฏูโูุง 4 API ุฏุฑ `render_inquiry_row()`
2. โ ฺฺฉ ฺฉุฑุฏู ุชูุธูุงุช (ูุนุงู ุจูุฏู ูุฑ API)
3. โ ุณุงุฎุช ุขุฑุงู `$finnotech_indicators` ุจุง ุขฺฉููโูุง ุฌุฏุงฺฏุงูู
4. โ ููุงุด ุขฺฉููโูุง ุฏุฑ ุณุชูู "Car" (ููุท ุจุฑุง ุงุฏูู)
5. โ ุงุถุงูู ฺฉุฑุฏู ุฏุงุฏูโูุง Finnotech ุจู AJAX response

---

## โ ููู ฺุฒ ฺฉุงูู ุงุณุช!

**ุชุงุฑุฎ ุจุฑุฑุณ:** 2025-11-04  
**ูุถุนุช:** ุชูุงู ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู โ
